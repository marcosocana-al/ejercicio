<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendario de Ejercicios para Lara</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* Base styles */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDF8F5; /* Very light warm off-white */
            color: #525252; /* Warm dark grey text */
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            padding: 1rem;
            box-sizing: border-box;
        }
        .main-layout {
            display: flex;
            flex-direction: row; /* Default to side-by-side */
            max-width: 1200px; /* Increased max-width for side-by-side layout */
            width: 100%;
            margin: 2rem auto;
            background-color: #ffffff;
            border-radius: 1.5rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            border: 1px solid #FEECE2;
            box-sizing: border-box;
            overflow: hidden; /* Ensures rounded corners are respected */
        }

        .sidebar-calendar {
            flex: 0 0 300px; /* Fixed width for calendar sidebar */
            padding: 1.5rem;
            background-color: #FFFBF8; /* Lighter peach for sidebar */
            border-right: 1px solid #FEECE2;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            margin-bottom: 1rem;
        }

        .calendar-toggle-btn {
            display: none; /* Hidden by default on desktop */
            background-color: #FCA38F;
            color: white;
            padding: 0.4rem 0.8rem; /* Adjusted padding for better look */
            border-radius: 0.5rem;
            font-weight: 600;
            font-size: 1.2rem;
            cursor: pointer;
            border: none;
            transition: background-color 0.3s ease;
        }
        .calendar-toggle-btn:hover {
            background-color: #E87D67;
        }

        .main-content {
            flex: 1; /* Takes remaining space */
            padding: 2rem;
            display: flex;
            flex-direction: column;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 2rem;
            text-align: center;
            color: #E87D67; /* Muted coral heading */
            font-weight: 800;
            letter-spacing: -0.025em;
        }
        h2 {
            font-size: 2rem;
            margin-top: 2.5rem;
            margin-bottom: 1.25rem;
            color: #E87D67; /* Medium coral */
            font-weight: 700;
            border-bottom: 2px solid #FEECE2;
            padding-bottom: 0.5rem;
        }
        h3 {
            font-size: 1.5rem;
            font-weight: 600;
            color: #FCA38F; /* Lighter salmon */
            margin-bottom: 1rem;
        }
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-bottom: 2rem;
            border-radius: 0.75rem;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        th, td {
            padding: 1rem 1.25rem;
            text-align: left;
            border-bottom: 1px solid #FEECE2;
        }
        th {
            background-color: #FEECE2;
            font-weight: 700;
            color: #E87D67;
            text-transform: uppercase;
            font-size: 0.875rem;
        }
        tr:nth-child(even) {
            background-color: #FFF5F0;
        }
        tr:last-child td {
            border-bottom: none;
        }

        .exercise-section {
            margin-bottom: 1.5rem;
            padding: 1rem;
            background-color: #FFFBF8;
            border-radius: 0.5rem;
            border: 1px solid #FEECE2;
        }
        .exercise-item {
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px dashed #FEECE2;
        }
        .exercise-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }
        .exercise-title {
            font-weight: 600;
            color: #1f2937;
            font-size: 1.125rem;
            margin-bottom: 0.25rem;
        }
        .exercise-description {
            color: #4a5568;
            font-size: 0.95rem;
        }
        .icon {
            display: inline-block;
            margin-right: 0.5rem;
            font-size: 1.2rem;
        }
        .callout {
            background-color: #E0F2F1; /* Light mint/aqua */
            border-left: 5px solid #A7D9D6; /* Medium mint/aqua border */
            padding: 1.25rem;
            margin-bottom: 2rem;
            border-radius: 0.75rem;
            color: #4A8C88; /* Darker mint/aqua text */
            font-size: 1.1rem;
            font-weight: 500;
        }
        .image-placeholder {
            width: 100%;
            height: 180px;
            background-color: #FEECE2;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #FCA38F;
            border-radius: 0.5rem;
            margin-top: 0.75rem;
            font-style: italic;
            font-size: 0.9rem;
        }

        /* Calendar styles */
        .calendar-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%; /* Ensure nav takes full width of sidebar */
            margin-bottom: 1rem;
        }
        .calendar-nav button {
            background-color: #FCA38F;
            color: white;
            padding: 0.5rem 0.75rem; /* Smaller padding for compact buttons */
            border-radius: 0.5rem;
            font-weight: 600;
            transition: background-color 0.3s ease;
        }
        .calendar-nav button:hover {
            background-color: #E87D67;
        }
        .calendar-header {
            font-size: 1.2rem; /* Smaller font for sidebar calendar header */
            font-weight: 700;
            color: #E87D67;
        }
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.2rem; /* Smaller gap for compact calendar */
            margin-bottom: 1rem;
            text-align: center;
            width: 100%; /* Ensure grid takes full width of sidebar */
        }
        .calendar-day-name {
            font-weight: 600;
            color: #525252;
            padding: 0.3rem; /* Smaller padding */
            font-size: 0.75rem; /* Smaller font for day names */
        }
        .calendar-day {
            padding: 0.4rem; /* Smaller padding for calendar cells */
            border-radius: 0.5rem;
            background-color: #FDF8F5;
            border: 1px solid #FEECE2;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.2s ease;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 50px; /* Smaller height for compact calendar */
        }
        .calendar-day:hover {
            background-color: #FFF5F0;
            transform: translateY(-1px); /* Smaller hover effect */
        }
        .calendar-day.current-day {
            background-color: #FCA38F;
            color: white;
            font-weight: 700;
            border-color: #E87D67;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); /* Smaller shadow */
        }
        .calendar-day.current-day .day-number,
        .calendar-day.current-day .day-routine {
            color: white;
        }
        .calendar-day.empty {
            background-color: transparent;
            border: none;
            cursor: default;
        }
        .day-number {
            font-size: 1rem; /* Smaller day number */
            font-weight: 600;
            color: #2d3748;
        }
        .day-routine {
            font-size: 0.65rem; /* Smaller routine text */
            color: #4a5568;
            margin-top: 0.1rem; /* Reduced margin */
            line-height: 1.1;
            text-align: center;
        }

        /* Daily Routine Display */
        .daily-routine-section {
            background-color: #ffffff; /* White background for main content */
            padding: 1.5rem;
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
            border: 1px solid #FEECE2;
            margin-top: 1.5rem;
            flex-grow: 1; /* Allows it to take available space */
        }
        .daily-routine-section h2 {
            margin-top: 0; /* Reset margin for this h2 */
            border-bottom: none;
            padding-bottom: 0;
        }

        /* Inspiration Feature styles */
        .inspiration-container {
            margin-top: 2rem;
            text-align: center;
            width: 100%; /* Ensure it spans full width of main-content */
        }
        .llm-feature-button {
            background-color: #FCA38F;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            display: inline-block;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .llm-feature-button:hover:not(:disabled) {
            background-color: #E87D67;
            transform: translateY(-2px);
        }
        .llm-feature-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            opacity: 0.7;
            transform: none;
        }

        #inspirationOutput {
            margin-top: 1.5rem;
            padding: 1.5rem;
            background-color: #FFF5E0;
            border-radius: 0.75rem;
            border: 1px solid #FDD18B;
            color: #78350f;
            font-size: 1rem;
            line-height: 1.5;
            display: none;
            text-align: left;
        }
        #inspirationOutput p {
            margin-bottom: 0.5rem;
        }
        #inspirationOutput p:last-child {
            margin-bottom: 0;
        }
        #inspirationOutput strong {
            color: #B45309;
        }
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #FCA38F;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            margin: 1rem auto;
            display: none;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Mobile-specific adjustments */
        @media (max-width: 768px) {
            .main-layout {
                flex-direction: column; /* Stack vertically on mobile */
                margin: 1rem auto;
                padding: 0; /* Remove padding from main-layout, sections will have it */
            }
            .sidebar-calendar {
                flex: none; /* Remove fixed flex basis */
                width: 100%;
                padding: 1rem;
                border-right: none;
                border-bottom: 1px solid #FEECE2; /* Add bottom border */
                border-radius: 1.5rem 1.5rem 0 0; /* Round top corners only */
                max-height: 500px; /* Sufficiently large to show content initially */
                transition: max-height 0.5s ease-out;
                overflow: hidden; /* Hide overflow when collapsing */
            }
            .sidebar-calendar.collapsed {
                max-height: 80px; /* Height when collapsed (just header and button) */
            }
            .sidebar-header h2 {
                margin-bottom: 0; /* Remove bottom margin when button is present */
            }
            .calendar-toggle-btn {
                display: block; /* Show on mobile */
            }
            .calendar-content {
                /* This div will be hidden/shown by max-height on parent */
                opacity: 1;
                transition: opacity 0.3s ease-out;
            }
            .sidebar-calendar.collapsed .calendar-content {
                opacity: 0;
                pointer-events: none; /* Disable interactions when hidden */
            }

            .main-content {
                padding: 1rem;
                width: 100%;
                border-radius: 0 0 1.5rem 1.5rem; /* Round bottom corners only */
            }
            h1 {
                font-size: 1.75rem;
                margin-bottom: 1rem;
            }
            h2 {
                font-size: 1.5rem;
                margin-top: 1.5rem;
                margin-bottom: 0.75rem;
            }
            h3 {
                font-size: 1.25rem;
                margin-bottom: 0.75rem;
            }
            th, td {
                padding: 0.6rem;
                font-size: 0.8rem;
            }
            .callout {
                padding: 0.8rem;
                font-size: 0.9rem;
                margin-bottom: 1rem;
            }
            .image-placeholder {
                height: 100px;
                font-size: 0.7rem;
            }
            .calendar-nav {
                flex-direction: row; /* Keep buttons side-by-side for small calendar */
                justify-content: space-between;
                gap: 0.25rem;
            }
            .calendar-nav button {
                padding: 0.4rem 0.6rem;
                font-size: 0.75rem;
            }
            .calendar-header {
                font-size: 1rem;
            }
            .calendar-grid {
                gap: 0.1rem;
            }
            .calendar-day-name {
                padding: 0.2rem;
                font-size: 0.65rem;
            }
            .calendar-day {
                padding: 0.3rem;
                min-height: 40px;
            }
            .day-number {
                font-size: 0.8rem;
            }
            .day-routine {
                font-size: 0.55rem;
            }
            .daily-routine-section {
                padding: 1rem;
                margin-top: 1rem;
            }
            .exercise-section {
                padding: 0.6rem;
                margin-bottom: 0.8rem;
            }
            .exercise-item {
                margin-bottom: 0.6rem;
                padding-bottom: 0.6rem;
            }
            .exercise-title {
                font-size: 0.95rem;
            }
            .exercise-description {
                font-size: 0.8rem;
            }
            .llm-feature-button {
                padding: 0.5rem 1rem;
                font-size: 0.95rem;
            }
            #inspirationOutput {
                padding: 1rem;
                font-size: 0.85rem;
            }
        }
    </style>
</head>
<body class="bg-blue-50 text-gray-700">
    <div class="main-layout">
        <div id="sidebarCalendar" class="sidebar-calendar">
            <div class="sidebar-header">
                <h2 class="text-xl font-bold mb-4" style="color: #E87D67;">Calendario</h2>
                <button id="calendarToggleBtn" class="calendar-toggle-btn">&#9776;</button>
            </div>
            <div class="calendar-content">
                <div class="calendar-nav">
                    <button id="prevMonth">&lt; Anterior</button>
                    <div id="monthYear" class="calendar-header"></div>
                    <button id="nextMonth">Siguiente &gt;</button>
                </div>
                <div class="calendar-grid">
                    <div class="calendar-day-name">Lun</div>
                    <div class="calendar-day-name">Mar</div>
                    <div class="calendar-day-name">Mié</div>
                    <div class="calendar-day-name">Jue</div>
                    <div class="calendar-day-name">Vie</div>
                    <div class="calendar-day-name">Sáb</div>
                    <div class="calendar-day-name">Dom</div>
                </div>
            </div>
        </div>

        <div class="main-content">
            <h1>🗓️ Tu Plan de Ejercicio Diario</h1>

            <div class="callout">
                <p>¡Este calendario está diseñado para ti! Cada ejercicio te ayudará a sentirte más fuerte y conectar con tu cuerpo, así como quemar energía para dormir mejor. Recuerda escuchar siempre a tu cuerpo y disfrutar del proceso. ¡Vamos a darle caña!</p>
            </div>

            <div id="dailyRoutineDisplay" class="daily-routine-section">
                <h2 id="dailyRoutineTitle" style="color: #E87D67;"></h2>
                <div id="dailyRoutineContent">
                    <p class="text-gray-600">Selecciona un día del calendario para ver tu rutina.</p>
                </div>
            </div>

            <div class="inspiration-container">
                <button id="getInspirationBtn" class="llm-feature-button">✨ Inspiración del Día ✨</button>
                <div id="loadingSpinner" class="loading-spinner"></div>
                <div id="inspirationOutput"></div>
            </div>
        </div>
    </div>

    <script>
        // Data for routines
        const routines = {
            "Lunes": {
                name: "Rutina 1 (¡A darle caña!)",
                type: "routine",
                exercises: [
                    { name: "Sentadillas clásicas", series: 3, reps: 15, desc: "Ponte de pie con los pies a la altura de tus caderas. Baja el culete como si te fueras a sentar en una silla, manteniendo la espalda recta y el pecho erguido. Asegúrate de que tus rodillas no sobrepasen los dedos de los pies. Sube apretando los glúteos a tope. ¡Este es un básico que trabaja todo el tren inferior!", img: "https://placehold.co/400x200/FEECE2/FCA38F?text=Sentadillas+clásicas" },
                    { name: "Puente de glúteos", series: 3, reps: 15, desc: "Túmbate boca arriba con las rodillas dobladas y los pies apoyados cerca de tu culete. Levanta la cadera del suelo apretando los glúteos con todas tus fuerzas, formando una línea recta desde tus hombros hasta tus rodillas. Mantén un segundo arriba y baja despacio. ¡Siente cómo trabaja el culete y la parte de atrás de tus muslos!", img: "https://placehold.co/400x200/FEECE2/FCA38F?text=Puente+de+glúteos" },
                    { name: "Zancadas adelante", series: 3, reps: "10 por pierna", desc: "Da un paso largo hacia adelante con una pierna, bajando la cadera hasta que la rodilla de atrás casi toque el suelo (¡pero sin golpearte!). La rodilla de adelante debe estar alineada con el tobillo. Empuja para volver a la posición inicial y repite con la otra pierna.", img: "https://placehold.co/400x200/FEECE2/FCA38F?text=Zancadas+adelante" },
                    { name: "Abducción lateral tumbada", series: 3, reps: "15 por pierna", desc: "Túmbate de lado, apoyando tu cabeza en tu brazo. Mantén las piernas estiradas y levanta la de arriba hacia el techo, sintiendo cómo trabaja el lateral del glúteo y la cadera (el glúteo medio y mínimo). Baja despacio y cambia de lado.", img: "https://placehold.co/400x200/FEECE2/FCA38F?text=Abducción+lateral+tumbada" },
                    { name: "Patada de glúteo (Donkey Kicks)", series: 3, reps: "15 por pierna", desc: "Ponte a cuatro patas (manos bajo los hombros, rodillas bajo las caderas). Manteniendo la rodilla doblada a 90 grados, levanta una pierna hacia atrás y arriba, como si quisieras \"patear el techo\" con la planta del pie. Aprieta el glúteo a tope en la parte superior y baja lentamente. Repite con la otra pierna.", img: "https://placehold.co/400x200/FEECE2/FCA38F?text=Patada+de+glúteos" },
                    { name: "Almejas (Clamshells)", series: 3, reps: "15 por lado", desc: "Túmbate de lado con las rodillas flexionadas y los pies juntos. Manteniendo los pies juntos, levanta la rodilla de arriba separándola de la de abajo, como si abrieras una almeja. ¡Ojo! No dejes que tu cadera rote hacia atrás. Baja lentamente. Repite del otro lado.", img: "https://placehold.co/400x200/FEECE2/FCA38F?text=Almejas" }
                ]
            },
            "Martes": {
                name: "Core y Flexibilidad (o descanso activo)",
                type: "active_rest",
                description: "Si tienes bici, elije rutas por zonas tranquilas, parques o carriles bici donde se sienta segura. Intenta mantener un ritmo constante, no competitivo. Un pedaleo suave y continuado de 30 a 45 minutos es ideal para un día de descanso activo. Si quieres intensificar un poco sin correr, puedes añadir pequeños tramos de subida si encuentras alguna cuesta."
            },
            "Miércoles": {
                name: "Rutina 2 (¡Más!)",
                type: "routine",
                exercises: [
                    { name: "Sentadillas sumo", series: 3, reps: 15, desc: "Abre las piernas más que el ancho de tus hombros, con las puntas de los pies un poco hacia fuera (como una bailarina de sumo, ¡de ahí el nombre!). Baja el culete como en una sentadilla normal, apretando bien los glúteos al subir.", img: "https://placehold.co/400x200/FEECE2/FCA38F?text=Sentadillas+sumo" },
                    { name: "Hip Thrust (espalda en silla/cama)", series: 3, reps: 15, desc: "Siéntate en el suelo con la parte alta de tu espalda (justo debajo de los omóplatos) apoyada en el borde de una silla o cama (¡que sea súper estable, por favor!). Pies apoyados en el suelo, rodillas flexionadas. Levanta la cadera apretando los glúteos a tope, hasta formar una línea recta con tu cuerpo desde los hombros hasta las rodillas. Baja despacio.", img: "https://placehold.co/400x200/FEECE2/FCA38F?text=Hip+Thrust" },
                    { name: "Zancadas laterales", series: 3, reps: "10 por pierna", desc: "Da un paso grande hacia un lado, doblando esa rodilla y manteniendo la otra pierna estirada. Baja la cadera y vuelve al centro. Cambia de lado.", img: "https://placehold.co/400x200/FEECE2/FCA38F?text=Zancadas+laterales" },
                    { name: "Elevación lateral de pierna de pie", series: 3, reps: "12 por pierna", desc: "De pie, puedes apoyarte en una pared o silla para mantener el equilibrio. Levanta una pierna recta hacia el lado, sin inclinar el cuerpo. Siente cómo trabaja el lateral de tu glúteo. Baja despacio y cambia de pierna.", img: "https://placehold.co/400x200/FEECE2/FCA38F?text=Elevación+lateral+de+pie" },
                    { name: "Puente de glúteos a una pierna", series: 3, reps: "12 por pierna", desc: "Como el puente de glúteos normal, pero estira una pierna hacia arriba. Levanta la cadera con una sola pierna apoyada. Alterna.", img: "https://placehold.co/400x200/FEECE2/FCA38F?text=Puente+a+una+pierna" },
                    { name: "Step Up (escalón/silla)", series: 3, reps: "10 por pierna", desc: "Ponte delante de un escalón o una silla resistente. Sube un pie, luego el otro, y baja de la misma forma, alternando la pierna que empieza. ¡Concéntrate en el glúteo de la pierna que sube al impulsarte!", img: "https://placehold.co/400x200/FEECE2/FCA38F?text=Step+Up" }
                ]
            },
            "Jueves": {
                name: "Descanso Activo (Caminar, estiramientos suaves, bici, yoga... ¡lo que te apetezca!)",
                type: "active_rest",
                description: "Busca en YouTube \"yoga suave para principiantes\" o \"estiramientos de yoga para despertar\" (para la mañana) o \"yoga para dormir\" (para la noche). Suelen ser rutinas de 10-15 minutos que se pueden hacer en el suelo de su habitación, usando una toalla o una manta fina si no tiene esterilla. También hay secuencias específicas para \"yoga para abrir caderas\" o \"yoga para dolor lumbar\" que complementan muy bien los ejercicios."
            },
            "Viernes": {
                name: "Rutina 3 (¡Último empujón!)",
                type: "routine",
                exercises: [
                    { name: "Sentadillas con salto", series: 3, reps: 12, desc: "Igual que la sentadilla clásica, pero al subir, haz un pequeño salto explosivo y aterriza suavemente para volver a bajar. ¡Te da un extra de intensidad y ayuda a quemar más calorías! Si al principio te cuesta, haz sentadillas normales y luego añade el salto.", img: "https://placehold.co/400x200/FEECE2/FCA38F?text=Sentadillas+con+salto" },
                    { name: "Zancadas caminando", series: 3, reps: "12 por pierna", desc: "Da un paso largo hacia adelante y baja como en una zancada normal. En vez de volver al sitio, lleva la pierna de atrás hacia adelante para dar el siguiente paso, como si estuvieras caminando en zancadas.", img: "https://placehold.co/400x200/FEECE2/FCA38F?text=Zancadas+caminando" },
                    { name: "Sentadilla isométrica (pared)", series: 3, reps: "30 seg cada una", desc: "Apoya tu espalda en una pared y baja como si te sentaras en una silla invisible, hasta que tus rodillas formen un ángulo de 90 grados. Mantén esa posición. ¡Aguanta ahí todo lo que puedas!", img: "https://placehold.co/400x200/FEECE2/FCA38F?text=Sentadilla+isométrica" },
                    { name: "Skater (salto lateral)", series: 3, reps: "20 (total)", desc: "Salta de lado a lado, aterrizando sobre un solo pie y llevando la otra pierna por detrás, como si patinaras. Mantén el equilibrio y salta al otro lado.", img: "https://placehold.co/400x200/FEECE2/FCA38F?text=Skater" },
                    { name: "Elevación de pantorrillas (gemelos)", series: 3, reps: 20, desc: "Ponte de pie, puedes apoyarte en una pared. Levanta los talones del suelo, apoyándote solo en las puntas de los pies, y luego baja lentamente.", img: "https://placehold.co/400x200/FEECE2/FCA38F?text=Elevación+de+pantorrillas" },
                    { name: "Patada de glúteo de pie hacia atrás", series: 3, reps: "15 por pierna", desc: "Ponte de pie, puedes apoyarte en una pared. Estira una pierna recta hacia atrás y levántala lo más alto que puedas, apretando el glúteo. Baja lentamente y repite.", img: "https://placehold.co/400x200/FEECE2/FCA38F?text=Patada+de+glúteo+de+pie" }
                ]
            },
            "Sábado": {
                name: "Descanso o Actividad Ligera (Yoga suave, bailar, bici... ¡muévete a tu aire!)",
                type: "active_rest",
                description: "¡Pon tu música favorita a todo volumen y baila como si nadie te viera! Es un ejercicio súper divertido, te libera, te hace sentir bien y te ayuda a mover el cuerpo. ¡Nadie te ve, así que a soltarse la melena y disfrutar a tope! Puedes buscar tutoriales de baile de estilos que te gusten (hip-hop, danza contemporánea, incluso ballet si te mola) en YouTube, ¡o simplemente improvisar tus propios pasos! 💃<br><br>A veces, una buena caminata rápida por el barrio o por un parque puede hacer maravillas. Es gratis, te despeja la mente, te ayuda a mantenerte activa y a quemar calorías. ¡Ponte unos cascos y tu música favorita! Propongo caminar entre 30 y 60 minutos a un ritmo que le permita hablar pero con un poco de dificultad (para que sea \"paso ligero\" y no solo un paseo relajado). Intenta centrarte en la sensación de tus pasos, en la respiración, en el entorno."
            },
            "Domingo": {
                name: "Descanso Total (¡A recargar pilas!)",
                type: "rest",
                description: "¡Día de descanso total! Aprovecha para relajarte, hacer actividades que te gusten y recargar energías para la semana. ¡El descanso es tan importante como el ejercicio!"
            }
        };

        const warmUpContent = `
            <div class="exercise-section">
                <h3 class="text-xl font-semibold mb-4" style="color: #4A8C88;"><span class="icon">🔥</span> Calentamiento (5-10 minutos)</h3>
                <p class="text-gray-600 mb-4">Antes de Empezar:</p>
                <div class="exercise-item">
                    <div class="exercise-title">Marcha en el sitio</div>
                    <p class="exercise-description">Levanta las rodillas alternativamente como si marcharas. Esto sube tu ritmo cardíaco suavemente y calienta las piernas.</p>
                </div>
                <div class="exercise-item">
                    <div class="exercise-title">Círculos de brazos pequeños</div>
                    <p class="exercise-description">Hacia adelante y hacia atrás (suaves, sin forzar). Esto ayuda a lubricar las articulaciones de los hombros.</p>
                </div>
                <div class="exercise-item">
                    <div class="exercise-title">Rotaciones de tronco suaves</div>
                    <p class="exercise-description">Gira el torso suavemente de lado a lado. Ideal para la movilidad de la columna y preparar el core.</p>
                </div>
                <div class="exercise-item">
                    <div class="exercise-title">Estiramientos dinámicos generales</div>
                    <p class="exercise-description">Patadas ligeras hacia adelante y hacia los lados, balanceos de pierna. Esto estira los músculos de forma activa y prepara las articulaciones para el movimiento.</p>
                </div>
                <div class="exercise-item">
                    <div class="exercise-title">Balanceo de pierna lateral</div>
                    <p class="exercise-description">De pie, puedes apoyarte en una pared. Balancea una pierna hacia un lado y luego cruzando por delante del cuerpo. Repite con la otra pierna. Activa los glúteos medios y flexores de cadera.</p>
                </div>
                <div class="exercise-item">
                    <div class="exercise-title">Rotaciones de cadera (circulares)</div>
                    <p class="exercise-description">De pie, o a cuatro patas, haz círculos amplios con la rodilla o la pierna para movilizar la articulación de la cadera. Haz círculos en ambas direcciones.</p>
                </div>
                <div class="exercise-item">
                    <div class="exercise-title">Caminata con zancada lateral y toque de pie</div>
                    <p class="exercise-description">Da un paso lateral, baja ligeramente en una sentadilla y toca el pie con la mano opuesta, luego vuelve a subir y repite al otro lado.</p>
                </div>
            </div>
        `;

        const coolDownContent = `
            <div class="exercise-section">
                <h3 class="text-xl font-semibold mb-4" style="color: #4A8C88;"><span class="icon">🧊</span> Enfriamiento y Estiramientos (5-10 minutos)</h3>
                <p class="text-gray-600 mb-4">Después de Terminar:</p>
                <p class="text-gray-600 mb-4">Esto es para relajar los músculos, mejorar tu flexibilidad y ayudar a que se recuperen. Mantén cada estiramiento durante 20-30 segundos, sin hacer rebotes. ¡Respira hondo y relájate! Es tu momento para desconectar y sentirte bien.</p>
                <div class="exercise-item">
                    <div class="exercise-title">Estiramiento de cuádriceps</div>
                    <p class="exercise-description">De pie, sujeta un tobillo y tira del talón hacia el culete. Siente el estiramiento en la parte delantera del muslo.</p>
                </div>
                <div class="exercise-item">
                    <div class="exercise-title">Estiramiento de pecho</div>
                    <p class="exercise-description">Entrelaza las manos detrás de la espalda y estira los brazos hacia arriba (suavemente, ¡sin forzar!). Esto ayuda a abrir el pecho y mejorar la postura, contrarrestando cualquier tensión.</p>
                </div>
                <div class="exercise-item">
                    <div class="exercise-title">Estiramiento de tríceps</div>
                    <p class="exercise-description">Lleva un codo por encima de la cabeza y empújalo suavemente con la otra mano. Estira la parte de atrás del brazo.</p>
                </div>
                <div class="exercise-item">
                    <div class="exercise-title">Estiramiento de la espalda baja</div>
                    <p class="exercise-description">Túmbate boca arriba, lleva las rodillas al pecho y abrázalas. Esto alivia la tensión en la espalda baja y es súper relajante.</p>
                </div>
                <div class="exercise-item">
                    <div class="exercise-title">Estiramiento de la figura 4 (Piriformis Stretch)</div>
                    <p class="exercise-description">Tumbada boca arriba, cruza un tobillo sobre la rodilla opuesta. Tira suavemente de la rodilla de abajo hacia tu pecho para sentir el estiramiento profundo en el glúteo de la pierna cruzada. Mantén y cambia de lado.</p>
                </div>
                <div class="exercise-item">
                    <div class="exercise-title">Estiramiento de la paloma (Yoga Pigeon Pose)</div>
                    <p class="exercise-description">Desde una posición de plancha, lleva una rodilla hacia adelante y colócala cerca de tu muñeca opuesta, con la espinilla cruzada (o lo más cerca posible de ser paralela al borde de la colchoneta). Estira la otra pierna hacia atrás. Inclínate suavemente hacia adelante si puedes. Siente el estiramiento en la cadera y el glúteo. Cambia de lado.</p>
                </div>
                <div class="exercise-item">
                    <div class="exercise-title">Estiramiento de glúteo tumbado con rodilla al pecho y cruce</div>
                    <p class="exercise-description">Tumbada boca arriba, lleva una rodilla al pecho. Luego, con la mano opuesta, tira suavemente de esa rodilla cruzándola hacia el lado opuesto del cuerpo, intentando mantener los hombros pegados al suelo. Siente el estiramiento en el glúteo y la parte exterior del muslo. Cambia de lado.</p>
                </div>
            </div>
        `;

        const dayNames = ["Domingo", "Lunes", "Martes", "Miércoles", "Jueves", "Viernes", "Sábado"]; // Sunday is 0

        // Global array to store inspirations
        const inspirations = [
            {
                "quote": "El cuerpo logra lo que la mente cree.",
                "microActivity": "Haz 5 respiraciones profundas, concentrándote en el aire que entra y sale.",
                "reflectionQuestion": "¿Qué pequeño paso puedo dar hoy para sentirme más fuerte?"
            },
            {
                "quote": "Cada día es una nueva oportunidad para ser mejor.",
                "microActivity": "Bebe un vaso de agua antes de tu primera taza de café.",
                "reflectionQuestion": "¿Qué hábito saludable te gustaría empezar o reforzar hoy?"
            },
            {
                "quote": "La disciplina es el puente entre metas y logros.",
                "microActivity": "Dedica 10 minutos a organizar un pequeño espacio en tu casa.",
                "reflectionQuestion": "¿Qué te motiva a mantenerte constante en tus objetivos?"
            },
            {
                "quote": "Tu salud es tu mayor riqueza.",
                "microActivity": "Estírate suavemente durante 5 minutos al despertar.",
                "reflectionQuestion": "¿Cómo puedes nutrir tu cuerpo y mente hoy?"
            },
            {
                "quote": "Pequeños cambios, grandes resultados.",
                "microActivity": "Da un paseo corto al aire libre.",
                "reflectionQuestion": "¿Qué actividad te hace sentir más conectada contigo misma?"
            },
            {
                "quote": "La perseverancia es la clave del éxito.",
                "microActivity": "Aprende una palabra nueva en otro idioma.",
                "reflectionQuestion": "¿Qué desafío reciente superaste con perseverancia?"
            },
            {
                "quote": "Eres más fuerte de lo que crees.",
                "microActivity": "Escribe tres cosas por las que estás agradecida hoy.",
                "reflectionQuestion": "¿Qué fortalezas descubriste en ti misma esta semana?"
            }
        ];

        function getRoutineForDay(dayIndex) {
            return routines[dayNames[dayIndex]];
        }

        function displayDailyRoutine(dayName, routineData) {
            const dailyRoutineTitle = document.getElementById('dailyRoutineTitle');
            const dailyRoutineContent = document.getElementById('dailyRoutineContent');
            
            dailyRoutineTitle.textContent = `${dayName} - ${routineData.name}`;
            let contentHtml = '';

            if (routineData.type === "routine") {
                contentHtml += warmUpContent;
                contentHtml += `
                    <div class="exercise-section">
                        <h3 class="text-xl font-semibold mb-4" style="color: #E87D67;">Detalle de Ejercicios: ${routineData.name}</h3>
                        <p class="mb-4 text-gray-600">Haz 3 series de las repeticiones indicadas para cada ejercicio. Descansa 30-60 segundos entre ejercicios. ¡Y siempre aprieta bien el músculo en cada repetición! ¡Siente cómo trabaja ese músculo! La clave es la conexión mente-músculo, pensar en el músculo que estás trabajando. Si un ejercicio te cuesta mucho al principio, haz menos repeticiones y ve aumentando poco a poco. ¡Sin prisas!</p>
                        <div class="overflow-x-auto rounded-xl shadow-md mb-4">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Ejercicio</th>
                                        <th>Series</th>
                                        <th>Repeticiones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${routineData.exercises.map(ex => `
                                        <tr>
                                            <td>${ex.name}</td>
                                            <td>${ex.series}</td>
                                            <td>${ex.reps}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                        <p class="mb-4 text-gray-600">¿Cómo se hace cada ejercicio? (¡Paso a paso para que no te pierdas ni una!)</p>
                        ${routineData.exercises.map(ex => `
                            <div class="exercise-item">
                                <div class="exercise-title">${ex.name}</div>
                                <p class="exercise-description">${ex.desc}</p>
                                <img src="${ex.img}" alt="Imagen de persona realizando ${ex.name}" class="image-placeholder">
                            </div>
                        `).join('')}
                    </div>
                `;
                contentHtml += coolDownContent;
            } else {
                contentHtml += `
                    <div class="exercise-section">
                        <h3 class="text-xl font-semibold mb-4" style="color: #E87D67;">${routineData.name}</h3>
                        <p class="exercise-description">${routineData.description}</p>
                    </div>
                `;
            }
            dailyRoutineContent.innerHTML = contentHtml;
        }

        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();

        function renderCalendar() {
            const calendarGrid = document.querySelector('.calendar-grid');
            const monthYearDisplay = document.getElementById('monthYear');
            calendarGrid.innerHTML = `
                <div class="calendar-day-name">Lun</div>
                <div class="calendar-day-name">Mar</div>
                <div class="calendar-day-name">Mié</div>
                <div class="calendar-day-name">Jue</div>
                <div class="calendar-day-name">Vie</div>
                <div class="calendar-day-name">Sáb</div>
                <div class="calendar-day-name">Dom</div>
            `; // Clear and re-add day names

            const firstDayOfMonth = new Date(currentYear, currentMonth, 1);
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            const today = new Date();

            // Adjust first day of week to be Monday (0 for Monday, 6 for Sunday)
            let firstDayOfWeek = firstDayOfMonth.getDay();
            firstDayOfWeek = (firstDayOfWeek === 0) ? 6 : firstDayOfWeek - 1; // Convert Sunday (0) to 6, others -1

            monthYearDisplay.textContent = `${firstDayOfMonth.toLocaleString('es-ES', { month: 'long' })} ${currentYear}`;

            // Add empty cells for days before the first day of the month
            for (let i = 0; i < firstDayOfWeek; i++) {
                const emptyDiv = document.createElement('div');
                emptyDiv.classList.add('calendar-day', 'empty');
                calendarGrid.appendChild(emptyDiv);
            }

            // Add days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(currentYear, currentMonth, day);
                const dayOfWeekIndex = date.getDay(); // 0 for Sunday, 1 for Monday...
                const dayName = dayNames[dayOfWeekIndex];
                const routine = routines[dayName];

                const dayDiv = document.createElement('div');
                dayDiv.classList.add('calendar-day');
                dayDiv.dataset.dayName = dayName; // Store day name for click event
                dayDiv.dataset.dayIndex = dayOfWeekIndex; // Store day index for direct routine lookup

                if (date.getDate() === today.getDate() && date.getMonth() === today.getMonth() && date.getFullYear() === today.getFullYear()) {
                    dayDiv.classList.add('current-day');
                }

                dayDiv.innerHTML = `
                    <span class="day-number">${day}</span>
                    <span class="day-routine">${routine ? routine.name.split('(')[0].trim() : ''}</span>
                `;
                calendarGrid.appendChild(dayDiv);
            }

            // Add event listeners to calendar days
            document.querySelectorAll('.calendar-day:not(.empty)').forEach(dayDiv => {
                dayDiv.addEventListener('click', () => {
                    // Remove 'current-day' from previously selected day
                    document.querySelectorAll('.calendar-day').forEach(d => d.classList.remove('current-day'));
                    // Add 'current-day' to the newly selected day
                    dayDiv.classList.add('current-day');

                    const dayName = dayDiv.dataset.dayName;
                    const routineData = routines[dayName];
                    if (routineData) {
                        displayDailyRoutine(dayName, routineData);
                    }
                });
            });
        }

        document.getElementById('prevMonth').addEventListener('click', () => {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
        });

        document.getElementById('nextMonth').addEventListener('click', () => {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            renderCalendar();
        });

        // Flag to ensure inspiration is generated only once per session
        let inspirationGenerated = false;

        // Function to display a random inspiration (either from local array or LLM)
        async function displayRandomInspiration() {
            const inspirationOutput = document.getElementById('inspirationOutput');
            const loadingSpinner = document.getElementById('loadingSpinner');
            const getInspirationBtn = document.getElementById('getInspirationBtn');

            // Only generate if not already generated
            if (inspirationGenerated) {
                return;
            }

            inspirationOutput.style.display = 'none'; // Hide previous output
            loadingSpinner.style.display = 'block'; // Show spinner
            getInspirationBtn.disabled = true; // Disable button immediately

            try {
                // First, try to get a random inspiration from the local array
                if (inspirations.length > 0) {
                    const randomIndex = Math.floor(Math.random() * inspirations.length);
                    const randomInspiration = inspirations[randomIndex];
                    inspirationOutput.innerHTML = `
                        <p><strong>Cita Motivacional:</strong> "${randomInspiration.quote}"</p>
                        <p><strong>Micro-actividad:</strong> ${randomInspiration.microActivity}</p>
                        <p><strong>Pregunta para Reflexionar:</strong> ${randomInspiration.reflectionQuestion}</p>
                    `;
                    inspirationOutput.style.display = 'block';
                    inspirationGenerated = true; // Set flag to true
                } else {
                    // If local inspirations are empty, fall back to LLM
                    let chatHistory = [];
                    chatHistory.push({ role: "user", parts: [{ text: "Genera una cita motivacional corta sobre ejercicio y bienestar, una sugerencia de micro-actividad para días de baja energía (ej. '5 minutos de estiramientos suaves') y una pregunta de reflexión sobre el bienestar personal. Formato JSON." }] });
                    
                    const payload = {
                        contents: chatHistory,
                        generationConfig: {
                            responseMimeType: "application/json",
                            responseSchema: {
                                type: "OBJECT",
                                properties: {
                                    "quote": { "type": "STRING" },
                                    "microActivity": { "type": "STRING" },
                                    "reflectionQuestion": { "type": "STRING" }
                                },
                                "propertyOrdering": ["quote", "microActivity", "reflectionQuestion"]
                            }
                        }
                    };
                    const apiKey = "";
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                    
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    
                    const result = await response.json();

                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        const json = result.candidates[0].content.parts[0].text;
                        const parsedJson = JSON.parse(json);

                        inspirationOutput.innerHTML = `
                            <p><strong>Cita Motivacional:</strong> "${parsedJson.quote}"</p>
                            <p><strong>Micro-actividad:</strong> ${parsedJson.microActivity}</p>
                            <p><strong>Pregunta para Reflexionar:</strong> ${parsedJson.reflectionQuestion}</p>
                        `;
                        inspirationOutput.style.display = 'block';
                        inspirationGenerated = true; // Set flag to true
                    } else {
                        inspirationOutput.innerHTML = '<p>Lo siento, no pude generar una inspiración en este momento. Inténtalo de nuevo.</p>';
                        inspirationOutput.style.display = 'block';
                    }
                }
            } catch (error) {
                console.error('Error al obtener la inspiración:', error);
                inspirationOutput.innerHTML = '<p>Hubo un error al cargar la inspiración. Por favor, inténtalo de nuevo más tarde.</p>';
                inspirationOutput.style.display = 'block';
            } finally {
                loadingSpinner.style.display = 'none'; // Hide spinner
            }
        }

        // Toggle calendar sidebar visibility on mobile
        document.getElementById('calendarToggleBtn').addEventListener('click', () => {
            const sidebarCalendar = document.getElementById('sidebarCalendar');
            sidebarCalendar.classList.toggle('collapsed');
        });

        // Initial render and display current day's routine on page load
        window.onload = async () => {
            renderCalendar();
            // Automatically display today's routine
            const today = new Date();
            const todayDayOfWeekIndex = today.getDay(); // 0 for Sunday, 1 for Monday...
            const todayDayName = dayNames[todayDayOfWeekIndex];
            const todayRoutine = routines[todayDayName];
            if (todayRoutine) {
                displayDailyRoutine(todayDayName, todayRoutine);
                // Highlight today's date in the calendar
                const todayDiv = document.querySelector(`.calendar-day.current-day`);
                if (todayDiv) {
                    todayDiv.classList.add('current-day');
                }
            }
            await displayRandomInspiration(); // Call the random inspiration function on load
        };
    </script>
</body>
</html>
